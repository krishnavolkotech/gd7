<?php 

/**
 * implements hook_mail
 */
use Drupal\Component\Utility\SafeMarkup;

function problem_management_mail($key, &$message, $params = array()) {
 // echo '<pre>'; print_r($message); 
 // echo '<pre>'; print_r($params);
 // exit; 

  $options = array(
                   'langcode' => $message['langcode'],
                   );
 // pr($message);exit;
  switch ($key) {
    case 'problem_management_read_csv':
  //  $message['from'] = \Drupal::config('system.site')->get('mail');
    $message['from'] = $message['from'];
    $message['subject'] = $params['subject'];
    //$message['body'][] = $params['message'];
   //  $message['body'][] = SafeMarkup::checkPlain($params['message']);
     $message['body'][] = $params['message'];
    $message['headers']['Content-Type'] = 'text/html; charset=UTF-8; format=flowed; delsp=yes';
//    break;
  }
}
